# README — Automated Classification of Primary Headache Disorders

**Repository author:** Ghaith Al‑Gburi  

## Study context
Primary headache disorders (e.g., migraine, tension‑type headache, and trigeminal autonomic cephalalgias) are among the most prevalent and disabling neurological conditions. Accurate diagnosis in routine clinical practice can be challenging, particularly in primary care settings.  
This repository accompanies a research study that implements an **automated, rule‑based classification system** for primary headache disorders using the **ICHD‑3 beta diagnostic criteria**, applied to structured questionnaire data.

---

## Purpose
The purpose of this repository is to:
- Implement an **automated classification pipeline** for primary headache disorders.
- Compare **automated diagnoses** against **specialist (gold‑standard) diagnoses**.
- Quantify **classification accuracy** at the first and second diagnostic levels.
- Explore **patterns of misclassification**, particularly tension‑type headache cases misclassified as migraine.
- Examine whether **background factors** (e.g., age, gender, survey version) are associated with classification accuracy.

---

## Quick view
- **`classify_headache.ipynb`** — Main Jupyter Notebook containing the full analysis and classification pipeline.
- **`classify_headache.html`** — Rendered HTML version of the notebook for easy viewing.
- **`Item_coding_and_assignment_procedure.xlsx`** — Detailed documentation of questionnaire items, coding, diagnostic conditions, and hierarchy.

---

## Files in this repository
- **`classify_headache.ipynb`** — Python notebook implementing automated ICHD‑3 beta classification, accuracy analyses, and visualizations.  
- **`classify_headache.html`** — Rendered HTML report of the notebook outputs.  
- **`Item_coding_and_assignment_procedure.xlsx`** — Reference file describing:
  - Item names and descriptions  
  - Coding schemes  
  - Diagnostic condition membership  
  - Diagnostic hierarchy  
- **`primary_headache_output.csv`** — Output file generated by the notebook containing automated diagnoses and accuracy labels.
- **`README.md`** — This documentation file.

---

## Required Python version & packages
- **Python version:** ≥ 3.9 recommended  

### Required packages
- `pandas`
- `numpy`
- `scipy`
- `matplotlib`
- `seaborn`
- `typing`

Install dependencies using:
```bash
pip install pandas numpy scipy matplotlib seaborn
```

---

## Expected input data
The notebook expects a CSV file named:

```
primary_headache_data.csv
```

### Data structure
- Each row represents one participant.
- Columns correspond to questionnaire items (e.g., `I1`, `I2`, …).
- Item meanings, coding, and diagnostic roles are fully documented in:
  **`Item_coding_and_assignment_procedure.xlsx`**.

Examples of variables include:
- Demographics: age (`I7`), gender (`I8`), education (`I9`)
- Headache features: duration (`I10`), site (`I22`), character (`I23`), severity (`I30`)
- Migraine‑related symptoms: nausea (`I25`), photophobia (`I27`), phonophobia (`I28`)
- Aura characteristics: `I11`–`I19`

---

## How to run the analysis

### Option 1 — Run interactively
1. Place `primary_headache_data.csv` in the same directory.
2. Open `classify_headache.ipynb` in Jupyter Notebook or JupyterLab.
3. Run all cells sequentially.

### Option 2 — View results only
Open `classify_headache.html` in any web browser to view the complete analysis and figures.

---

## Analysis workflow
The notebook performs the following steps:

1. **Environment setup**  
   Loads required Python libraries and reads the input CSV file.

2. **Descriptive statistics**  
   Summarizes demographic variables, survey characteristics, and medication use.

3. **Automated primary headache classification**  
   Implements rule‑based diagnostic functions corresponding to ICHD‑3 beta categories, including:
   - Migraine without aura  
   - Migraine with aura  
   - Chronic migraine  
   - Episodic and chronic tension‑type headache  
   - Trigeminal autonomic cephalalgias  
   - Probable headache diagnoses

4. **Classification accuracy assessment**  
   Compares automated diagnoses with specialist diagnoses at:
   - First diagnostic level  
   - Second diagnostic level  
   Produces agreement tables and visualizations.

5. **Misclassification analysis**  
   Examines cases of tension‑type headache misclassified as migraine and explores symptom patterns driving misclassification.

6. **Association with background factors**  
   Uses non‑parametric tests (Kruskal–Wallis, Fisher’s exact test) and effect sizes to assess whether age, response time, gender, education, or data source influence classification accuracy.

7. **Output generation**  
   Exports a CSV file containing automated diagnoses and accuracy labels.

---

## License
This repository is released under the **GNU Affero General Public License v3.0 (AGPL‑3.0)**.  
See the `LICENSE` file for details.

---

## Contact
**Author:** Ghaith Al‑Gburi  
**Email:** ghaith.ali.khaleel@gmail.com  
**GitHub:** https://github.com/GhaithAl-Gburi  
**ORCID:** 0000‑0001‑7427‑8310
